<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZIIAX - Exclusive Videos App</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Watch trending short videos under 60 seconds, anytime, anywhere">
    <meta name="theme-color" content="#6c5ce7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="VideoHub">
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%236c5ce7'/><polygon points='35,25 35,75 75,50' fill='white'/></svg>">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, onValue, off } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCEn0pwj7gKBB0mob55bbTBMlfNnmTcSmo",
            authDomain: "ziiax-videos.firebaseapp.com",
            databaseURL: "https://ziiax-videos-default-rtdb.firebaseio.com",
            projectId: "ziiax-videos",
            storageBucket: "ziiax-videos.firebasestorage.app",
            messagingSenderId: "583938479266",
            appId: "1:583938479266:web:d9bfeb83f89cc2905933fb",
            measurementId: "G-HFDXB4DWHX"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        
        // Make Firebase functions available globally
        window.firebaseApp = app;
        window.firebaseDatabase = database;
        window.firebaseRef = ref;
        window.firebaseOnValue = onValue;
        window.firebaseOff = off;
    </script>
    
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: hsl(250, 69%, 61%);
            --secondary: hsl(250, 69%, 75%);
            --accent: hsl(337, 91%, 73%);
            --dark: hsl(210, 20%, 20%);
            --light: hsl(210, 17%, 98%);
            --white: hsl(0, 0%, 100%);
            --gray-100: hsl(0, 0%, 98%);
            --gray-200: hsl(0, 0%, 96%);
            --gray-300: hsl(0, 0%, 90%);
            --gray-400: hsl(0, 0%, 80%);
            --gray-500: hsl(0, 0%, 60%);
            --gray-600: hsl(0, 0%, 40%);
            --gray-700: hsl(0, 0%, 30%);
            --gray-800: hsl(0, 0%, 20%);
            --gray-900: hsl(0, 0%, 10%);
            --radius: 0.5rem;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
            }
            to {
                transform: translateX(0);
            }
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .animate-slide-in {
            animation: slideIn 0.3s ease-out;
        }

        .animate-modal-fade-in {
            animation: modalFadeIn 0.3s ease-out;
        }

        .animate-slide-up {
            animation: slideUp 0.3s ease-out;
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        /* Header */
        .header {
            background: var(--white);
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo {
            width: 2.5rem;
            height: 2.5rem;
            background: var(--primary);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
        }

        .logo.small {
            width: 2rem;
            height: 2rem;
        }

        .app-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .install-button {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--white);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 500;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .install-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(108, 92, 231, 0.3);
        }

        .hidden {
            display: none !important;
        }

        /* Main Content */
        .main-content {
            padding: 2rem 0;
        }

        .welcome-section {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeIn 0.5s ease-out;
        }

        .welcome-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 1rem;
        }

        .welcome-description {
            font-size: 1.125rem;
            color: var(--gray-600);
            max-width: 42rem;
            margin: 0 auto;
        }

        /* Loading State */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 0;
            gap: 1rem;
        }

        .loading-spinner {
            width: 3rem;
            height: 3rem;
            border: 3px solid var(--gray-300);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
        }

        .loading-text {
            font-size: 1.125rem;
            color: var(--gray-600);
        }

        /* Error State */
        .error-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 0;
            gap: 1rem;
            text-align: center;
        }

        .error-icon {
            width: 4rem;
            height: 4rem;
            background: var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.5rem;
        }

        .error-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark);
        }

        .error-message {
            font-size: 1rem;
            color: var(--gray-600);
            max-width: 32rem;
        }

        .retry-button {
            background: var(--primary);
            color: var(--white);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .retry-button:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        /* Video Grid */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .video-card {
            background: var(--white);
            border-radius: 1rem;
            box-shadow: var(--shadow);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .video-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(108, 92, 231, 0.2);
        }

        .video-thumbnail {
            position: relative;
            width: 100%;
            height: 18rem;
            background: linear-gradient(45deg, var(--gray-200), var(--gray-300));
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            aspect-ratio: 16/9;
        }

        .video-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .no-thumbnail {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 1;
        }

        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 3.75rem;
            height: 3.75rem;
            background: rgba(108, 92, 231, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.125rem;
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        .play-button i {
            margin-left: 0.125rem;
        }

        .video-card:hover .play-button {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.1);
        }

        .duration-badge {
            position: absolute;
            bottom: 0.5rem;
            right: 0.5rem;
            background: rgba(0, 0, 0, 0.7);
            color: var(--white);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
        }

        .shorts-badge {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            background: var(--primary);
            color: var(--white);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .video-card-content {
            padding: 1rem;
        }

        .video-card-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-card-description {
            font-size: 0.875rem;
            color: var(--gray-600);
            margin-bottom: 0.75rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-card-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        .video-card-meta span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* Fullscreen Video Player */
        .video-modal {
            position: fixed;
            inset: 0;
            background: var(--gray-900);
            z-index: 100;
            display: flex;
            flex-direction: column;
            animation: modalFadeIn 0.3s ease-out;
            overflow: hidden;
        }

        .video-player-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .video-player {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            background: #000;
        }

        .video-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            padding: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .video-modal:hover .video-controls {
            opacity: 1;
        }

        .close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.8;
            transition: all 0.2s ease;
            width: 3rem;
            height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            z-index: 15;
        }

        .close-button:hover {
            opacity: 1;
            background: rgba(0, 0, 0, 0.7);
        }

        .video-modal .replay-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: linear-gradient(145deg, var(--primary), var(--secondary));
            border: 3px solid var(--white);
            color: var(--white);
            font-size: 2.5rem;
            cursor: pointer;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            width: 5rem;
            height: 5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            z-index: 9999;
            pointer-events: none;
            box-shadow: 0 0 30px rgba(108, 92, 231, 0.5), 
                        0 0 60px rgba(108, 92, 231, 0.3),
                        inset 0 0 20px rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        .video-modal .replay-overlay::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s ease;
        }

        .video-modal .video-modal .replay-overlay.show,
        .video-modal .replay-overlay.show {
            opacity: 1 !important;
            pointer-events: auto !important;
            transform: translate(-50%, -50%) scale(1) !important;
            animation: replayPulse 2s infinite ease-in-out !important;
            visibility: visible !important;
            display: flex !important;
            z-index: 99999 !important;
        }

        .video-modal .replay-overlay:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 0 40px rgba(108, 92, 231, 0.7), 
                        0 0 80px rgba(108, 92, 231, 0.4),
                        inset 0 0 30px rgba(255, 255, 255, 0.2);
            background: linear-gradient(145deg, var(--secondary), var(--primary));
        }

        .video-modal .replay-overlay:hover::before {
            left: 100%;
        }

        .video-modal .replay-overlay:active {
            transform: translate(-50%, -50%) scale(0.95);
        }

        @keyframes replayPulse {
            0%, 100% {
                box-shadow: 0 0 30px rgba(108, 92, 231, 0.5), 
                            0 0 60px rgba(108, 92, 231, 0.3),
                            inset 0 0 20px rgba(255, 255, 255, 0.1);
            }
            50% {
                box-shadow: 0 0 40px rgba(108, 92, 231, 0.8), 
                            0 0 80px rgba(108, 92, 231, 0.5),
                            inset 0 0 30px rgba(255, 255, 255, 0.2);
            }
        }

        .replay-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
        }

        .replay-content i {
            font-size: 2rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .replay-text {
            font-size: 0.7rem;
            font-weight: 700;
            letter-spacing: 0.1rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            font-family: 'Inter', sans-serif;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .control-button {
            background: transparent;
            border: none;
            color: var(--white);
            font-size: 1.25rem;
            cursor: pointer;
            opacity: 0.8;
            transition: all 0.2s ease;
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .control-button:hover {
            opacity: 1;
            background: rgba(255, 255, 255, 0.1);
        }

        .control-button.large {
            font-size: 1.75rem;
        }

        .progress-container {
            position: absolute;
            bottom: 4.5rem;
            left: 0;
            right: 0;
            padding: 0 1.5rem;
            z-index: 10;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }

        .progress {
            height: 100%;
            background: var(--primary);
            width: 0%;
            position: relative;
        }

        .progress::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            border: 2px solid var(--white);
        }

        .time-display {
            color: var(--white);
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2rem;
            }

            .video-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .video-thumbnail {
                height: 14rem;
            }

            .header-content {
                padding: 0.75rem 0;
            }

            .app-title {
                font-size: 1.25rem;
            }

            .install-button {
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }

            .video-controls {
                padding: 1rem;
            }

            .control-group {
                gap: 1rem;
            }

            .progress-container {
                bottom: 3.5rem;
                padding: 0 1rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 0.75rem;
            }

            .welcome-title {
                font-size: 1.75rem;
            }

            .welcome-description {
                font-size: 1rem;
            }

            .video-card-content {
                padding: 0.75rem;
            }

            .video-thumbnail {
                height: 12rem;
            }
        }

        /* PWA Styles */
        @media (display-mode: standalone) {
            .header {
                padding-top: env(safe-area-inset-top);
            }
        }

        /* Empty State */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 0;
            gap: 1rem;
            text-align: center;
        }

        .empty-icon {
            width: 4rem;
            height: 4rem;
            background: var(--gray-300);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-600);
            font-size: 1.5rem;
        }

        .empty-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark);
        }

        .empty-message {
            font-size: 1rem;
            color: var(--gray-600);
            max-width: 32rem;
        }

        /* Offline State Styles */
        .offline-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 0;
            gap: 2rem;
            text-align: center;
        }

        .offline-animation {
            position: relative;
            width: 6rem;
            height: 6rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wifi-icon {
            position: relative;
            width: 4rem;
            height: 4rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wifi-circle {
            position: absolute;
            border: 3px solid var(--primary);
            border-radius: 50%;
            border-top-color: transparent;
            border-right-color: transparent;
            animation: wifiPulse 2s infinite ease-in-out;
        }

        .wifi-circle:nth-child(1) {
            width: 1.5rem;
            height: 1.5rem;
            animation-delay: 0s;
        }

        .wifi-circle:nth-child(2) {
            width: 2.5rem;
            height: 2.5rem;
            animation-delay: 0.3s;
            opacity: 0.7;
        }

        .wifi-circle:nth-child(3) {
            width: 3.5rem;
            height: 3.5rem;
            animation-delay: 0.6s;
            opacity: 0.4;
        }

        .wifi-slash {
            position: absolute;
            width: 4px;
            height: 4rem;
            background: var(--accent);
            transform: rotate(45deg);
            border-radius: 2px;
            box-shadow: 0 0 10px var(--accent);
            animation: slashGlow 1.5s infinite alternate ease-in-out;
        }

        .offline-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark);
            margin: 0;
            background: linear-gradient(145deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .offline-message {
            font-size: 1.125rem;
            color: var(--gray-600);
            max-width: 28rem;
            line-height: 1.6;
            margin: 0;
        }

        .retry-connection-btn {
            background: linear-gradient(145deg, var(--primary), var(--secondary));
            color: var(--white);
            border: none;
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .retry-connection-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .retry-connection-btn:active {
            transform: translateY(0);
        }

        .retry-connection-btn i {
            animation: retryRotate 1s linear infinite paused;
        }

        .retry-connection-btn:hover i {
            animation-play-state: running;
        }

        @keyframes wifiPulse {
            0%, 100% {
                opacity: 0.3;
                transform: scale(0.8);
            }
            50% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes slashGlow {
            0% {
                box-shadow: 0 0 10px var(--accent);
                background: var(--accent);
            }
            100% {
                box-shadow: 0 0 20px var(--accent), 0 0 30px var(--accent);
                background: var(--secondary);
            }
        }

        @keyframes retryRotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">
                        <i class="fas fa-play"></i>
                    </div>
                    <h1 class="app-title">ZIIAX</h1>
                </div>
                <div class="header-actions">
                    <button id="installButton" class="install-button hidden">
                        <i class="fas fa-download"></i>
                        Install App
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
           

            <!-- Content Container -->
            <div id="content-container">
                <!-- Loading State -->
                <div id="loading-state" class="loading-container">
                    <div class="loading-spinner animate-spin"></div>
                    <p class="loading-text">Loading videos...</p>
                </div>

                <!-- Error State -->
                <div id="error-state" class="error-container hidden">
                    <div class="error-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h3 class="error-title">Unable to Load Videos</h3>
                    <p id="error-message" class="error-message">
                        Failed to connect to Firebase. Please check your internet connection and try again.
                    </p>
                    <button id="retry-button" class="retry-button">
                        <i class="fas fa-redo"></i> Retry
                    </button>
                </div>

                <!-- Empty State -->
                <div id="empty-state" class="empty-state hidden">
                    <div class="empty-icon">
                        <i class="fas fa-video"></i>
                    </div>
                    <h3 class="empty-title">No Videos Available</h3>
                    <p class="empty-message">
                        No videos found . Please check back later for new content.
                    </p>
                </div>

                <!-- No Internet State -->
                <div id="offline-state" class="offline-state hidden">
                    <div class="offline-animation">
                        <div class="wifi-icon">
                            <div class="wifi-circle"></div>
                            <div class="wifi-circle"></div>
                            <div class="wifi-circle"></div>
                            <div class="wifi-slash"></div>
                        </div>
                    </div>
                    <h3 class="offline-title">No Internet</h3>
                    <p class="offline-message">Please check your internet connection and try again</p>
                    <button id="retry-connection" class="retry-connection-btn">
                        <i class="fas fa-sync-alt"></i>
                        Try Again
                    </button>
                </div>

                <!-- Video Grid -->
                <div id="video-grid" class="video-grid hidden"></div>
            </div>
        </div>
    </main>

    <!-- Video Modal -->
    <div id="videoModal" class="video-modal hidden">
        <div class="video-player-container">
            <video id="videoPlayer" class="video-player">
                Your browser does not support the App.
            </video>

            <!-- Close Button (Top Right) -->
            <button id="closeBtn" class="close-button">
                <i class="fas fa-times"></i>
            </button>

            <!-- Replay Overlay (Center, shown after video ends) -->
            <button id="replayBtn" class="replay-overlay">
                <div class="replay-content">
                    <i class="fas fa-redo-alt"></i>
                    <div class="replay-text"></div>
                </div>
            </button>

            <!-- Progress Bar -->
            <div class="progress-container">
                <div id="progressBar" class="progress-bar">
                    <div id="progress" class="progress"></div>
                </div>
            </div>

            <!-- Video Controls -->
            <div class="video-controls">
                <div class="control-group">
                    <button id="playPauseBtn" class="control-button large">
                        <i class="fas fa-play"></i>
                    </button>
                    <button id="muteBtn" class="control-button">
                        <i class="fas fa-volume-up"></i>
                    </button>
                    <span id="timeDisplay" class="time-display">0:00 / 0:00</span>
                </div>

                <div class="control-group">
                    <button id="fullscreenBtn" class="control-button">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let deferredPrompt;
        let videosData = [];
        let currentVideoIndex = 0;
        let videosRef = null;

        // DOM Elements
        const installButton = document.getElementById('installButton');
        const videoGrid = document.getElementById('video-grid');
        const videoModal = document.getElementById('videoModal');
        const videoPlayer = document.getElementById('videoPlayer');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const muteBtn = document.getElementById('muteBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const closeBtn = document.getElementById('closeBtn');
        const replayBtn = document.getElementById('replayBtn');
        const progressBar = document.getElementById('progressBar');
        const progress = document.getElementById('progress');
        const timeDisplay = document.getElementById('timeDisplay');
        const retryButton = document.getElementById('retry-button');

        // State management elements
        const loadingState = document.getElementById('loading-state');
        const errorState = document.getElementById('error-state');
        const emptyState = document.getElementById('empty-state');
        const offlineState = document.getElementById('offline-state');
        const errorMessage = document.getElementById('error-message');
        const retryConnectionBtn = document.getElementById('retry-connection');

        // Network Detection
        function checkOnlineStatus() {
            return navigator.onLine;
        }

        function handleOffline() {
            console.log('App went offline');
            if (loadingState && !loadingState.classList.contains('hidden')) {
                showOffline();
            }
        }

        function handleOnline() {
            console.log('App back online');
            if (offlineState && !offlineState.classList.contains('hidden')) {
                initializeFirebase();
            }
        }

        // Firebase Database Functions
        function initializeFirebase() {
            // Check internet connection first
            if (!checkOnlineStatus()) {
                showOffline();
                return;
            }

            try {
                videosRef = window.firebaseRef(window.firebaseDatabase, 'videos');
                loadVideos();
            } catch (error) {
                console.error('Firebase initialization error:', error);
                // Check if it's a network issue
                if (!checkOnlineStatus() || error.message.includes('network') || error.message.includes('connection')) {
                    showOffline();
                } else {
                    showError('Failed to initialize Firebase connection: ' + error.message);
                }
            }
        }

        function loadVideos() {
            showLoading();
            
            window.firebaseOnValue(videosRef, (snapshot) => {
                try {
                    const data = snapshot.val();
                    
                    if (data) {
                        // Convert Firebase object to array
                        videosData = Object.keys(data).map(key => ({
                            id: key,
                            ...data[key]
                        }));
                        
                        console.log('Loaded videos:', videosData);
                        
                        if (videosData.length > 0) {
                            displayVideos();
                        } else {
                            showEmpty();
                        }
                    } else {
                        showEmpty();
                    }
                } catch (error) {
                    console.error('Error processing video data:', error);
                    showError('Failed to process video data: ' + error.message);
                }
            }, (error) => {
                console.error('Firebase data loading error:', error);
                // Check if it's a network issue
                if (!checkOnlineStatus() || error.message.includes('network') || error.message.includes('connection') || error.message.includes('offline')) {
                    showOffline();
                } else {
                    showError('Failed to load videos from Firebase: ' + error.message);
                }
            });
        }

        function showLoading() {
            loadingState.classList.remove('hidden');
            errorState.classList.add('hidden');
            emptyState.classList.add('hidden');
            offlineState.classList.add('hidden');
            videoGrid.classList.add('hidden');
        }

        function showError(message) {
            loadingState.classList.add('hidden');
            errorState.classList.remove('hidden');
            emptyState.classList.add('hidden');
            offlineState.classList.add('hidden');
            videoGrid.classList.add('hidden');
            errorMessage.textContent = message;
        }

        function showEmpty() {
            loadingState.classList.add('hidden');
            errorState.classList.add('hidden');
            emptyState.classList.remove('hidden');
            offlineState.classList.add('hidden');
            videoGrid.classList.add('hidden');
        }

        function showOffline() {
            loadingState.classList.add('hidden');
            errorState.classList.add('hidden');
            emptyState.classList.add('hidden');
            offlineState.classList.remove('hidden');
            videoGrid.classList.add('hidden');
        }

        function showVideos() {
            loadingState.classList.add('hidden');
            errorState.classList.add('hidden');
            emptyState.classList.add('hidden');
            offlineState.classList.add('hidden');
            videoGrid.classList.remove('hidden');
        }

        function displayVideos() {
            videoGrid.innerHTML = '';
            
            videosData.forEach((video, index) => {
                const videoCard = createVideoCard(video, index);
                videoGrid.appendChild(videoCard);
            });
            
            showVideos();
        }

        function createVideoCard(video, index) {
            const card = document.createElement('div');
            card.className = 'video-card animate-fade-in';
            card.style.animationDelay = `${index * 0.1}s`;
            
            // Format duration (handle both string and number formats)
            const formatDuration = (duration) => {
                if (!duration) return '0:00';
                
                // If duration is already a string in MM:SS format, return it
                if (typeof duration === 'string' && duration.includes(':')) {
                    return duration;
                }
                
                // If duration is a number (seconds), convert to MM:SS
                const durationNum = parseFloat(duration);
                if (!isNaN(durationNum)) {
                    const mins = Math.floor(durationNum / 60);
                    const secs = Math.floor(durationNum % 60);
                    return `${mins}:${secs.toString().padStart(2, '0')}`;
                }
                
                return '0:00';
            };

            // Format views/likes count (handle both string and number formats)
            const formatCount = (count) => {
                if (!count) return '0';
                
                // If count is already formatted as string (e.g., "89K", "2.1M"), return it
                if (typeof count === 'string' && (count.includes('K') || count.includes('M'))) {
                    return count;
                }
                
                // If count is a number, format it
                const countNum = parseFloat(count);
                if (!isNaN(countNum)) {
                    if (countNum >= 1000000) return (countNum / 1000000).toFixed(1) + 'M';
                    if (countNum >= 1000) return (countNum / 1000).toFixed(1) + 'K';
                    return countNum.toString();
                }
                
                return count.toString();
            };

            card.innerHTML = `
                <div class="video-thumbnail">
                    ${video.thumbnail ? 
                        `<img src="${video.thumbnail}" alt="${video.title || 'Video thumbnail'}" onerror="this.style.display='none';">` : 
                        `<div class="no-thumbnail">
                            <i class="fas fa-video" style="font-size: 2rem; color: var(--gray-400);"></i>
                            <div style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--gray-500);">No Image</div>
                        </div>`
                    }
                    <div class="play-button">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="duration-badge">${formatDuration(video.duration)}</div>
                    <div class="shorts-badge">HOT</div>
                </div>
                <div class="video-card-content">
                    <h3 class="video-card-title">${video.title || 'Untitled Video'}</h3>
                    <p class="video-card-description">${video.description || 'No description available'}</p>
                    <div class="video-card-meta">
                        <span>
                            <i class="fas fa-heart"></i>
                            ${formatCount(video.likes)}
                        </span>
                        <span>
                            <i class="fas fa-eye"></i>
                            ${formatCount(video.views)}
                        </span>
                    </div>
                </div>
            `;

            card.addEventListener('click', () => openVideoModal(index));
            return card;
        }

        function openVideoModal(index) {
            currentVideoIndex = index;
            const video = videosData[index];
            
            if (video && video.videoUrl) {
                videoPlayer.src = video.videoUrl;
                videoModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                
                // Reset player state
                videoPlayer.currentTime = 0;
                replayBtn.classList.remove('show');
                updateProgress();
                updateTimeDisplay();
                
                // Auto-play if supported
                videoPlayer.play().catch(e => console.log('Autoplay prevented:', e));
            } else {
                console.error('Video URL not found for index:', index);
                console.error('Available video data:', video);
                alert('Video not available. Please try another video.');
            }
        }

        function closeVideoModal() {
            videoModal.classList.add('hidden');
            document.body.style.overflow = '';
            videoPlayer.pause();
            videoPlayer.src = '';
            replayBtn.classList.remove('show');
        }

        function replayVideo() {
            videoPlayer.currentTime = 0;
            replayBtn.classList.remove('show');
            // Clear inline styles to reset replay button
            replayBtn.style.opacity = '';
            replayBtn.style.pointerEvents = '';
            replayBtn.style.visibility = '';
            replayBtn.style.display = '';
            replayBtn.style.zIndex = '';
            videoPlayer.play();
        }

        function togglePlayPause() {
            if (videoPlayer.paused) {
                videoPlayer.play();
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            } else {
                videoPlayer.pause();
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            }
        }

        function toggleMute() {
            videoPlayer.muted = !videoPlayer.muted;
            muteBtn.innerHTML = videoPlayer.muted 
                ? '<i class="fas fa-volume-mute"></i>' 
                : '<i class="fas fa-volume-up"></i>';
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                videoModal.requestFullscreen().catch(err => {
                    console.log('Error attempting to enable fullscreen:', err);
                });
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
            } else {
                document.exitFullscreen();
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
            }
        }

        function updateProgress() {
            if (videoPlayer.duration) {
                const progressPercent = (videoPlayer.currentTime / videoPlayer.duration) * 100;
                progress.style.width = progressPercent + '%';
            }
        }

        function updateTimeDisplay() {
            const current = formatTime(videoPlayer.currentTime);
            const duration = formatTime(videoPlayer.duration || 0);
            timeDisplay.textContent = `${current} / ${duration}`;
        }

        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function seekVideo(e) {
            const rect = progressBar.getBoundingClientRect();
            const percent = (e.clientX - rect.left) / rect.width;
            videoPlayer.currentTime = percent * videoPlayer.duration;
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Debug: Check if replay button exists
            console.log('Replay button element:', replayBtn);
            console.log('Replay button found:', !!replayBtn);
            
            // For demonstration: You can temporarily test offline screen by uncommenting below:
            // showOffline(); return;
            
            // Initialize Firebase when DOM is ready
            setTimeout(initializeFirebase, 100);
        });

        // Retry buttons
        retryButton.addEventListener('click', () => {
            initializeFirebase();
        });

        retryConnectionBtn.addEventListener('click', () => {
            // Add loading animation to button
            const icon = retryConnectionBtn.querySelector('i');
            icon.style.animationPlayState = 'running';
            
            setTimeout(() => {
                icon.style.animationPlayState = 'paused';
                initializeFirebase();
            }, 1000);
        });

        // Network status event listeners
        window.addEventListener('online', handleOnline);
        window.addEventListener('offline', handleOffline);

        // Video player event listeners
        videoPlayer.addEventListener('loadedmetadata', updateTimeDisplay);
        videoPlayer.addEventListener('timeupdate', () => {
            updateProgress();
            updateTimeDisplay();
        });

        videoPlayer.addEventListener('play', () => {
            playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            replayBtn.classList.remove('show');
            // Clear inline styles to reset replay button
            replayBtn.style.opacity = '';
            replayBtn.style.pointerEvents = '';
            replayBtn.style.visibility = '';
            replayBtn.style.display = '';
            replayBtn.style.zIndex = '';
        });

        videoPlayer.addEventListener('pause', () => {
            playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
        });

        videoPlayer.addEventListener('ended', () => {
            console.log('Video ended - showing replay button');
            playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            replayBtn.classList.add('show');
            // Force inline style to override any CSS conflicts - use setProperty for higher priority
            replayBtn.style.setProperty('opacity', '1', 'important');
            replayBtn.style.setProperty('pointer-events', 'auto', 'important');
            replayBtn.style.setProperty('visibility', 'visible', 'important');
            replayBtn.style.setProperty('display', 'flex', 'important');
            replayBtn.style.setProperty('z-index', '99999', 'important');
            console.log('Replay button classes:', replayBtn.classList.toString());
            console.log('Replay button computed style opacity:', window.getComputedStyle(replayBtn).opacity);
            console.log('Replay button computed style display:', window.getComputedStyle(replayBtn).display);
            console.log('Replay button computed style visibility:', window.getComputedStyle(replayBtn).visibility);
            console.log('Replay button computed style z-index:', window.getComputedStyle(replayBtn).zIndex);
            // Auto-play next video if available after 3 seconds if no replay
            if (currentVideoIndex < videosData.length - 1) {
                setTimeout(() => {
                    if (replayBtn.classList.contains('show')) {
                        openVideoModal(currentVideoIndex + 1);
                    }
                }, 3000);
            }
        });

        // Control event listeners
        playPauseBtn.addEventListener('click', togglePlayPause);
        muteBtn.addEventListener('click', toggleMute);
        fullscreenBtn.addEventListener('click', toggleFullscreen);
        closeBtn.addEventListener('click', closeVideoModal);
        replayBtn.addEventListener('click', replayVideo);
        progressBar.addEventListener('click', seekVideo);

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (!videoModal.classList.contains('hidden')) {
                switch(e.code) {
                    case 'Space':
                        e.preventDefault();
                        togglePlayPause();
                        break;
                    case 'Escape':
                        closeVideoModal();
                        break;
                    case 'KeyM':
                        toggleMute();
                        break;
                    case 'KeyF':
                        toggleFullscreen();
                        break;
                    case 'ArrowLeft':
                        videoPlayer.currentTime -= 10;
                        break;
                    case 'ArrowRight':
                        videoPlayer.currentTime += 10;
                        break;
                }
            }
        });

        // Fullscreen change event
        document.addEventListener('fullscreenchange', () => {
            fullscreenBtn.innerHTML = document.fullscreenElement 
                ? '<i class="fas fa-compress"></i>' 
                : '<i class="fas fa-expand"></i>';
        });

        // PWA Installation
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installButton.classList.remove('hidden');
        });

        installButton.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`User response to the install prompt: ${outcome}`);
                deferredPrompt = null;
                installButton.classList.add('hidden');
            }
        });

        window.addEventListener('appinstalled', () => {
            console.log('PWA was installed');
            installButton.classList.add('hidden');
        });

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').then((registration) => {
                    console.log('SW registered: ', registration);
                }).catch((registrationError) => {
                    console.log('SW registration failed: ', registrationError);
                });
            });
        }

        // Connection status monitoring
        window.addEventListener('online', () => {
            if (videosData.length === 0) {
                initializeFirebase();
            }
        });

        window.addEventListener('offline', () => {
            console.log('App is offline');
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (videosRef) {
                window.firebaseOff(videosRef);
            }
        });
    </script>
</body>
</html>
